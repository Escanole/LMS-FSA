<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Reports Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Course Reports Dashboard</h1>

        <!-- Tab Navigation -->
        <ul class="nav nav-tabs" id="reportTabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="individual-tab" data-bs-toggle="tab" href="#individual" role="tab" aria-controls="individual" aria-selected="true">Individual Progress</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="course-tab" data-bs-toggle="tab" href="#course" role="tab" aria-controls="course" aria-selected="false">Course Progress</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="overall-tab" data-bs-toggle="tab" href="#overall" role="tab" aria-controls="overall" aria-selected="false">Overall Progress</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="top-tab" data-bs-toggle="tab" href="#top" role="tab" aria-controls="top" aria-selected="false">Top Performers</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="risk-tab" data-bs-toggle="tab" href="#risk" role="tab" aria-controls="risk" aria-selected="false">At-Risk Students</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="last-tab" data-bs-toggle="tab" href="#last" role="tab" aria-controls="last" aria-selected="false">Last Accessed Courses</a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content mt-3" id="reportTabContent">
            <!-- Individual Progress Report -->
            <div class="tab-pane fade show active" id="individual" role="tabpanel" aria-labelledby="individual-tab">
                <div id="individual-report-content">
                    <p>Loading report...</p>
                </div>
            </div>

            <!-- Course Progress Report -->
            <div class="tab-pane fade" id="course" role="tabpanel" aria-labelledby="course-tab">
                <div id="course-report-content">
                    <p>Loading report...</p>
                </div>
            </div>

            <!-- Overall Progress Report -->
            <div class="tab-pane fade" id="overall" role="tabpanel" aria-labelledby="overall-tab">
                <div id="overall-report-content">
                    <p>Loading report...</p>
                </div>
            </div>

            <!-- Top Performers Report -->
            <div class="tab-pane fade" id="top" role="tabpanel" aria-labelledby="top-tab">
                <div id="top-report-content">
                    <p>Loading report...</p>
                </div>
            </div>

            <!-- At-Risk Students Report -->
            <div class="tab-pane fade" id="risk" role="tabpanel" aria-labelledby="risk-tab">
                <div id="risk-report-content">
                    <p>Loading report...</p>
                </div>
            </div>

            <!-- Last Accessed Courses Report -->
            <div class="tab-pane fade" id="last" role="tabpanel" aria-labelledby="last-tab">
                <div id="last-report-content">
                    <p>Loading report...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap and jQuery JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Function to load report content
        function loadReport(url, targetDiv) {
            $.ajax({
                url: url,
                method: 'GET',
                success: function(data) {
                    $(targetDiv).html(data); // Load the report content into the target div
                },
                error: function() {
                    $(targetDiv).html('<p>Error loading report. Please try again later.</p>');
                }
            });
        }

        // Load the initial report
        $(document).ready(function() {
            loadReport("{% url 'reports:individual_progress_report' user_id=1 %}", "#individual-report-content");
        });

        // Load reports on tab change
        $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
            var targetId = $(e.target).attr("href");
            var reportUrl = '';

            // Determine the URL based on the active tab
            switch (targetId) {
                case '#individual':
                    reportUrl = "{% url 'reports:individual_progress_report' user_id=1 %}";
                    break;
                case '#course':
                    reportUrl = "{% url 'reports:course_progress_report' course_id=1 %}";
                    break;
                case '#overall':
                    reportUrl = "{% url 'reports:overall_progress_report' %}";
                    break;
                case '#top':
                    reportUrl = "{% url 'reports:top_performers_report' %}";
                    break;
                case '#risk':
                    reportUrl = "{% url 'reports:at_risk_students_report' %}";
                    break;
                case '#last':
                    reportUrl = "{% url 'reports:last_accessed_report' %}";
                    break;
            }

            // Load the report content into the active tab
            loadReport(reportUrl, targetId + "-report-content");
        });
    </script>
</body>
</html>
