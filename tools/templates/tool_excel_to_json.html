{% extends 'base.html' %}
{% load static %}

{% block content %}
<head>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <link rel="stylesheet" href="{% static 'css/tools.css' %}">
</head>

<div class="container mt-5">
    <h2 class="mb-4 text-center">File to JSON Converter</h2>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs justify-content-center" id="fileConverterTabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="excel-tab" data-toggle="tab" href="#excel-content" role="tab">Excel to JSON</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="word-tab" data-toggle="tab" href="#word-content" role="tab">Word to JSON</a>
        </li>
    </ul>

    <div class="tab-content mt-4">
        <!-- Excel Tab Content -->
        <div class="tab-pane fade show active" id="excel-content" role="tabpanel">
            <form method="post" enctype="multipart/form-data" class="border p-4 rounded shadow-sm bg-light">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn btn-success btn-block mt-4">Upload and Convert</button>
            </form>

            {% if json_data %}
            <div class="mt-4">
                <h3>JSON Data</h3>
                <pre>{{ json_data|safe }}</pre>
                <a href="{% url 'tools:download_json_file' %}?file_name={{ json_file_name }}" class="btn btn-primary mt-3">Download JSON</a>
            </div>
            {% endif %}
        </div>

        <!-- Word Tab Content -->
        <div class="tab-pane fade" id="word-content" role="tabpanel">
            <form method="post" enctype="multipart/form-data" class="border p-4 rounded shadow-sm bg-light">
                {% csrf_token %}
                <div class="form-group">
                    <label for="wordFile">Upload Word File</label>
                    <input type="file" class="form-control-file" id="wordFile" name="word_file" accept=".doc,.docx" required>
                </div>
                <button type="submit" class="btn btn-success btn-block mt-4">Upload and Convert</button>
            </form>
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            <h4 class="text-center">Drag and Drop Excel Files</h4>
        </div>
        <div class="card-body">
            <form method="post" enctype="multipart/form-data" id="upload-form">
                {% csrf_token %}
                <div class="drop-zone" id="drop-zone">Drag your excel file here!</div>
                <input type="file" name="files" id="file-input" multiple hidden>
                <ul class="file-list" id="file-list"></ul>
                <div class="text-right">
                    <button type="submit" class="btn btn-primary">Convert</button>
                </div>
            </form>
        </div>
    </div>

    <div class="d-flex justify-content-end mt-3">
        <a href="{% url 'tools:view_tools' %}" class="btn btn-link">
            <i class="fas fa-arrow-left"></i> Back
        </a>
    </div>
</div>

<script src="{% static 'js/fileUpload.js' %}"></script>
{% endblock %}
